{"version":3,"file":"1-timer.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from 'flatpickr';\nimport 'flatpickr/dist/flatpickr.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet userDate = null;\n\nconst options = {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n  onClose(selectedDates) {\n    userDate = selectedDates[0];\n    dealWithTimer();\n  },\n};\nflatpickr('#datetime-picker', options);\n\nconst refs = {\n  dateInputEl: document.getElementById('datetime-picker'),\n  timerEl: document.querySelector('.timer'),\n  startBtn: document.querySelector('[data-start]'),\n  daysEl: document.querySelector('[data-days]'),\n  hoursEl: document.querySelector('[data-hours]'),\n  minutesEl: document.querySelector('[data-minutes]'),\n  secondsEl: document.querySelector('[data-seconds]'),\n};\n\nrefs.startBtn.addEventListener('click', onStartBtnClick);\n\nfunction isFutureDate(date) {\n  return date instanceof Date && date.getTime() > Date.now();\n}\n\nfunction timeDiff(date) {\n  return date.getTime() - Date.now();\n}\n\nfunction enableTimer() {\n  refs.startBtn.classList.add('active');\n  refs.startBtn.disabled = false;\n}\n\nfunction disableTimer() {\n  refs.startBtn.classList.remove('active');\n  refs.startBtn.disabled = true;\n}\n\nfunction showErrorMessage() {\n  iziToast.error({\n    title: 'Error',\n    message: 'Please choose a date in the future',\n    position: 'topRight',\n  });\n}\n\nfunction showSuccesMessage() {\n  iziToast.success({\n    title: 'Done!',\n    message: 'Time is up! Now click Start button.',\n    position: 'topRight',\n  });\n}\n\nfunction dealWithTimer() {\n  if (isFutureDate(userDate)) {\n    enableTimer();\n    showSuccesMessage();\n  } else {\n    disableTimer();\n    showErrorMessage();\n  }\n}\n\nfunction blockCalendar() {\n  refs.dateInputEl.disabled = true;\n}\n\nfunction enableCalendar() {\n  refs.dateInputEl.disabled = false;\n}\n\nfunction doubleNumToString(number) {\n  return String(number).padStart(2, '0');\n}\n\nfunction onStartBtnClick() {\n  TIMER.run();\n}\n\nconst TIMER = {\n  days: null,\n  hours: null,\n  minutes: null,\n  seconds: null,\n  intervalId: null,\n\n  run() {\n    blockCalendar();\n    disableTimer();\n\n    this.update();\n\n    this.intervalId = setInterval(() => {\n      if (timeDiff(userDate) <= 0) {\n        clearInterval(this.intervalId);\n        this.reset();\n        enableCalendar();\n        return;\n      }\n\n      this.update();\n    }, 1000);\n  },\n\n  update() {\n    const { days, hours, minutes, seconds } = convertMs(timeDiff(userDate));\n\n    this.days = doubleNumToString(days);\n    this.hours = doubleNumToString(hours);\n    this.minutes = doubleNumToString(minutes);\n    this.seconds = doubleNumToString(seconds);\n\n    this.render();\n  },\n\n  render() {\n    const { daysEl, hoursEl, minutesEl, secondsEl } = refs;\n\n    daysEl.textContent = this.days;\n    hoursEl.textContent = this.hours;\n    minutesEl.textContent = this.minutes;\n    secondsEl.textContent = this.seconds;\n  },\n\n  reset() {\n    this.days = null;\n    this.hours = null;\n    this.minutes = null;\n    this.seconds = null;\n    this.intervalId = null;\n  },\n};\n\nfunction convertMs(ms) {\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  const days = Math.floor(ms / day);\n  const hours = Math.floor((ms % day) / hour);\n  const minutes = Math.floor(((ms % day) % hour) / minute);\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n  return { days, hours, minutes, seconds };\n}\n"],"names":["userDate","options","selectedDates","dealWithTimer","flatpickr","refs","onStartBtnClick","isFutureDate","date","timeDiff","enableTimer","disableTimer","showErrorMessage","iziToast","showSuccesMessage","blockCalendar","enableCalendar","doubleNumToString","number","TIMER","days","hours","minutes","seconds","convertMs","daysEl","hoursEl","minutesEl","secondsEl","ms"],"mappings":"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"}